apiVersion: apps/v1
kind: Deployment
metadata:
  name: depl-safe
  namespace: deployment-safe
spec:
  replicas: 1
  selector:
    matchLabels:
      app: httpbin
      version: v1
  template:
    metadata:
      labels:
        app: httpbin
        version: v1
    spec:
      securityContext:
        sysctls:
          - name: kernel.shm_rmid_forced
            value: '1'
          - name: net.ipv4.ip_local_port_range
            value: '32000 64128'
          - name: net.ipv4.ip_unprivileged_port_start
            value: '28256'
          - name: net.ipv4.tcp_syncookies
            value: '2'
          - name: net.ipv4.ping_group_range
            value: '100 100'
      containers:
        - image: docker.io/kennethreitz/httpbin
          imagePullPolicy: IfNotPresent
          name: httpbin
          ports:
            - containerPort: 80
